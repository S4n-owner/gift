<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>LifeOS â€“ Trung tÃ¢m tÃ i sáº£n</title>

<style>
:root{
  --bg:#0b0f14;--card:#121821;--text:#e8ecf1;
  --accent:#00ff99;--danger:#ff4d4d;--border:#1f2a38;
}
body{margin:0;font-family:Segoe UI;background:var(--bg);color:var(--text)}
a{color:var(--accent);text-decoration:none;margin:12px;display:inline-block}
.section{background:var(--card);padding:16px;border-radius:14px;margin:16px;border:1px solid var(--border)}
.total{font-size:26px;font-weight:bold;color:var(--accent)}
input{width:100%;padding:10px;border-radius:8px;background:#0b0f14;color:white;border:1px solid var(--border)}
button{margin-top:8px;padding:8px 12px;border:none;border-radius:8px;background:var(--accent);font-weight:bold;cursor:pointer}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px}
.asset-card{background:#0b0f14;padding:12px;border-radius:10px;border:1px solid var(--border)}
.asset-card b{display:block;margin-top:6px;color:var(--accent)}
.item{display:grid;grid-template-columns:1fr 120px 40px;gap:8px;margin-top:8px}
.up{color:var(--accent)} .down{color:var(--danger)}
.warn{color:var(--danger);font-weight:bold;margin-top:6px}
</style>
</head>

<body>

<a href="finance.html">â† Quáº£n lÃ½ chi tiÃªu</a>

<div class="section">
<h2>ğŸ”„ Biáº¿n Ä‘á»™ng tÃ i sáº£n</h2>
<div>TrÆ°á»›c: <b id="beforeTotal">0 Ä‘</b></div>
<input type="number" id="changeMoney" placeholder="+ Tiá»n kiáº¿m Ä‘Æ°á»£c / - Tiá»n máº¥t Ä‘i">
<div>Biáº¿n Ä‘á»™ng: <b id="diff">0 Ä‘</b></div>
<div>Sau: <span id="afterTotal" class="total">0 Ä‘</span></div>
<button onclick="applyChange()">Ãp dá»¥ng</button>
</div>

<div class="section">
<h2>ğŸ’° Tá»•ng tÃ i sáº£n hiá»‡n táº¡i</h2>
<div id="totalAsset" class="total">0 Ä‘</div>
</div>

<div class="section">
<h2>ğŸ“Š PhÃ¢n bá»• chiáº¿n lÆ°á»£c</h2>
<div>60% PhÃ¡t triá»ƒn báº£n thÃ¢n: <b id="fund60">0 Ä‘</b></div>
<div>40% Äáº§u tÆ° & tiáº¿t kiá»‡m: <b id="fund40">0 Ä‘</b></div>
</div>

<div class="section">
<h2>ğŸ“ Äáº§u tÆ° phÃ¡t triá»ƒn báº£n thÃ¢n</h2>
<div id="selfList"></div>
<button onclick="addSelfItem()">â• ThÃªm danh má»¥c</button>
<div>
  Tá»•ng Ä‘Ã£ Ä‘áº§u tÆ°: <b id="selfTotal">0 Ä‘</b> / Quá»¹ 60%: <b id="selfLimit">0 Ä‘</b>
  <div id="selfWarn"></div>
</div>
</div>

<div class="section">
<h2>ğŸ“ˆ Tá»•ng quá»¹ Ä‘áº§u tÆ°</h2>
<div id="investTotal" class="total">0 Ä‘</div>
</div>

<div class="section">
<h2>ğŸ§© Danh má»¥c Ä‘áº§u tÆ°</h2>
<div class="grid">
  <div class="asset-card">ğŸš¨ Quá»¹ kháº©n cáº¥p<b id="emergency"></b></div>
  <div class="asset-card">ğŸ“Š ETF<b id="etf"></b></div>
  <div class="asset-card">ğŸ¢ Cá»• phiáº¿u<b id="stock"></b></div>
  <div class="asset-card">ğŸ›ï¸ Bluechip<b id="bluechip"></b></div>
  <div class="asset-card">âš¡ Crypto máº¡o hiá»ƒm<b id="crypto"></b></div>
  <div class="asset-card">ğŸ¥‡ VÃ ng<b id="gold"></b></div>
</div>
</div>

<script>
const f = n => Number(n||0).toLocaleString("vi-VN")+" Ä‘";

let total = Number(localStorage.getItem("lifeos_total")) || 0;
let selfItems = JSON.parse(localStorage.getItem("lifeos_self")) || [];

/* ================= BIáº¾N Äá»˜NG ================= */

changeMoney.addEventListener("input",()=>{
  const c = Number(changeMoney.value||0);
  beforeTotal.innerText = f(total);
  diff.innerText = (c>=0?"+":"") + f(c);
  diff.className = c>=0?"up":"down";
  afterTotal.innerText = f(total + c);
});

function applyChange(){
  total += Number(changeMoney.value||0);
  localStorage.setItem("lifeos_total", total);
  changeMoney.value = "";
  renderWealth();
}

/* ================= PHÃT TRIá»‚N Báº¢N THÃ‚N ================= */

function addSelfItem(){
  selfItems.push({name:"",money:""});
  saveSelf();
  renderSelf();
}

function saveSelf(){
  localStorage.setItem("lifeos_self", JSON.stringify(selfItems));
}

function updateSelfMoney(i,value){
  selfItems[i].money = value;
  saveSelf();
  renderWealth();   // CHá»ˆ tÃ­nh toÃ¡n â€“ KHÃ”NG váº½ láº¡i list
}

function updateSelfName(i,value){
  selfItems[i].name = value;
  saveSelf();
}

function removeSelf(i){
  selfItems.splice(i,1);
  saveSelf();
  renderSelf();
}

function renderSelf(){
  selfList.innerHTML = "";
  selfItems.forEach((it,i)=>{
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <input value="${it.name}" placeholder="VÃ­ dá»¥: Tiáº¿ng Anh"
        oninput="updateSelfName(${i},this.value)">
      <input type="number" value="${it.money}" placeholder="Sá»‘ tiá»n"
        oninput="updateSelfMoney(${i},this.value)">
      <button onclick="removeSelf(${i})">âœ•</button>`;
    selfList.appendChild(div);
  });
}

/* ================= TÃNH TOÃN TÃ€I Sáº¢N ================= */

function renderWealth(){
  totalAsset.innerText = f(total);
  beforeTotal.innerText = f(total);
  afterTotal.innerText = f(total);

  const fund60v = total * 0.6;
  const fund40v = total * 0.4;

  fund60.innerText = f(fund60v);
  fund40.innerText = f(fund40v);
  selfLimit.innerText = f(fund60v);

  const selfSum = selfItems.reduce((s,i)=>s+Number(i.money||0),0);
  selfTotal.innerText = f(selfSum);

  if(selfSum > fund60v){
    selfWarn.innerText = "âš ï¸ VÆ°á»£t quá»¹ 60%: " + f(selfSum - fund60v);
    selfWarn.className = "warn";
  } else selfWarn.innerText = "";

  /* 40% + 24% = 64% */
  const invest = total * 0.64;
  investTotal.innerText = f(invest);

  emergency.innerText = f(invest*0.20);
  etf.innerText       = f(invest*0.20);
  stock.innerText     = f(invest*0.15);
  bluechip.innerText  = f(invest*0.20);
  crypto.innerText    = f(invest*0.10);
  gold.innerText      = f(invest*0.15);
}

/* ================= KHá»I Äá»˜NG ================= */

renderSelf();
renderWealth();
</script>

</body>
</html>
